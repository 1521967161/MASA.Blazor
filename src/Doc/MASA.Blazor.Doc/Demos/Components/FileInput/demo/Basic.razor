@using System.Text.Json;
@using System.IO;

<MFileInput Files="@files" Upload="HandleUpload" Multiple ShowSize Counter Chips Accept="image/*">
    <Activator>
        <MButton Color="primary">Upload</MButton>
    </Activator>
</MFileInput>

@code {
    IList<UploadFile> files = new List<UploadFile>() {
    new UploadFile { FileName ="defaultFileName1", Url = "https://picsum.photos/510/300?random", Uploaded = true, IsImage = true },
    new UploadFile { FileName = "defaultFileNam2", Url = "https://picsum.photos/520/300?random", Uploaded = true, IsImage = true },
    };

    async Task HandleUpload(UploadFile file)
    {
        // TODO: upload to server
        var buffers = new byte[file.BrowserFile.Size];
        await file.BrowserFile.OpenReadStream().ReadAsync(buffers);
        // todo with buffers

        bool succeed = true;
        if (succeed)
        {
            // succeed to upload
            file.Uploaded = true;
            //file.Url = "";
        }
        else
        {

            // failed to upload
            file.Error = "Error happens";
        }
    }
}